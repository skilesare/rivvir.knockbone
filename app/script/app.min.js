(function(){var a,b,c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}},g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a=function(){function a(a){this.initApp=f(this.initApp,this);var b;b=this,null==window.constants&&(window.constants={}),window.constants.netEnv="debug",window.constants.serviceURL="http://localhost:56136","file:"===window.location.protocol||window.location.origin.indexOf("localhost")>-1?("debug"===window.constants.netEnv&&(window.constants.BaseURL="http://localhost:56136"),"production"===window.constants.netEnv&&(window.constants.BaseURL="http://localhost:56136")):window.constants.BaseURL=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host,this.$el=null,null!=a&&(this.$el=$(a)),this.settings=new Store("kb"),this.namespace="com.kblist.app",this.state=ko.observable("home"),this.isTestacular=!1,this.isInit=ko.observable(!1),this.utils=new e(this),this.navState=ko.observable(),this.activeListID=ko.observable("home"),this.navigation=new d(this),this.listItemHelper=new c(this),this.listEntry=ko.observable("Enter a new Item"),this.activeList=ko.observable([]),this.errorMessage=ko.observable()}return a.prototype.navigateTo=function(a,b){return null==b&&(b=!0),Backbone.history.navigate("!"+a,b)},a.prototype.initApp=function(a){return this.isInit(!0),$(".main").show(),$(".loading").hide(),async.series({getUser:function(a){return function(b){return null!=a.settings.get("userName")&&""!==a.settings.get("userName")&&null!=a.settings.get("password")&&""!==a.settings.get("password")?(a.users.userName(a.settings.get("userName")),a.users.password(a.settings.get("password")),a.users.sendLogon(function(){return b(null)},function(){return b("logon failed")})):b(null)}}(this),applyBinding:function(a){return function(b){return null!=a.$el?(ko.bindingHandlers.fadeOutIn={update:function(a){return $(a).hide(),setTimeout(function(){return $(a).fadeIn()},100)}},ko.bindingHandlers.datepicker={init:function(a,b,c){var d;return d=c().datepickerOptions||{},$(a).datepicker(d).on("changeDate",function(a){var c,d,e,f,g;return f="",null!=a.date.getDate&&(c=a.date.getDate(),d=a.date.getMonth()+1,g=a.date.getFullYear(),f=d+"/"+c+"/"+g),(e=b())(f)})},update:function(a,b){var c,d,e,f;return e=ko.utils.unwrapObservable(b()),null!=e.getDate?(c=e.getDate(),d=e.getMonth()+1,f=e.getFullYear(),e=d+"/"+c+"/"+f):e.indexOf("-")>-1&&(e=e.replace("-","/").replace("-","/")),$(a).datepicker("setValue",e)}},ko.bindingHandlers.bootstrapPopover={init:function(a,b){var c,d;return d=b(),c={},d=$.extend(!0,{},c,d),$(a).popover(d)}},ko.applyBindings(a,a.$el[0]),b(null)):b({error:"binding element not present for ko"})}}(this),setupEvents:function(a){return function(b){return document.addEventListener("resume",function(){return a.navigateTo("logon")}),document.addEventListener("online",function(){var b;return b=a.utils.getDateTime(),b=b.split(":")[1].toString()+"/"+b.split(":")[2]+"/"+b.split(":")[0],a.resAvailability.get(b,function(b){return a.resAvailability.schedule(b.items)})}),b(null)}}(this)},function(){return function(){return setTimeout(function(){return Backbone.history.stop(),Backbone.history.start()},1),null!=a?a():void 0}}(this)),null},a}(),null==window.kb&&(window.kb={}),null==window.kb.KBVM&&(window.kb.KBVM=a),b=function(){function a(a){this.options=a,this.text=ko.observable(""),this.dateAdded=ko.observable(null),this.dateComplete=ko.observable(null),this.bComplete=ko.observable(!1),this.listID=ko.observable(null),this.listItemID=ko.observable(null),null!=a&&(null!=a.text&&this.text(a.text),null!=a.dateAdded&&this.dateAdded(a.dateAdded),null!=a.dateComplete&&this.dateComplete(a.dateComplete),null!=a.bComplete&&this.bComplete(a.bComplete),null!=a.listID&&this.listID(a.listID),null!=a.listItemID&&this.listItemID(a.listItemID)),this.switchText=ko.computed(function(a){return function(){return a.bComplete()?"Undo Complete":"Complete"}}(this),this)}return a}(),null==window.kb&&(window.kb={}),null==window.kb.ListItemHelper&&(window.kb.ListItemHelper=c),d=function(a){function c(a,b){this.ensureFixture=f(this.ensureFixture,this),this.showHome=f(this.showHome,this),this.showHello=f(this.showHello,this),this.showError=f(this.showError,this),this.showPage=f(this.showPage,this),this.viewModel=a,this.options=b,c.__super__.constructor.call(this)}return h(c,a),c.prototype.routes={"":"showHome","!hello":"showHello","!home":"showHome","!home/:listID":"showHome","*path":"showHome"},c.prototype.showPage=function(a){return this.ensureFixture(a,function(b){return function(){var c;return b.viewModel.state(a),setTimeout(function(){return window.scroll(0,0)},15),setTimeout(function(){window.seojsSnapshotReady=!0},2e3),"undefined"!=typeof ga&&null!==ga?(c=window.location.href.split("#!"),c=2===c.length?c[1]:"",ga("send","event","pageChange",a,c)):void 0}}(this))},c.prototype.showError=function(a){return this.ensureSetUpApp(function(b){return function(){return b.viewModel.errorMessage=a,b.showPage("error")}}(this))},c.prototype.showHello=function(){return this.ensureSetUpApp(function(a){return function(){return a.showPage("hello")}}(this))},c.prototype.showHome=function(a){return this.ensureSetUpApp(function(c){return function(){return null!=a?null!=a&&c.viewModel.activeListID(a):c.viewModel.activeListID("home"),c.viewModel.listItemHelper.getList(c.viewModel.activeListID(),function(a){var d;return d=_.map(a,function(a){return new b(a)}),c.viewModel.activeList(d),c.showPage("home")},function(){return c.showPage("home")})}}(this))},c.prototype.ensureFixture=function(a,b){var c,d;return d="__state_"+a,c=$("#__fixtures").find("#"+d),0===c.length?$.ajax({url:"fixtures/state_"+a+".html",cache:!1,success:function(a){return function(c){var e;return e="<div id='"+d+"'>"+c+"</div>",$("#__fixtures").append(e),ko.applyBindings(a.viewModel,$("#"+d)[0]),null!=b?b():void 0}}(this)}):null!=b?b():void 0},c.prototype.ensureSetUpApp=function(a){return this.viewModel.isInit()?this.viewModel.utils.foundConnection()?a():this.viewModel.navigateTo("connection"):this.viewModel.initApp(function(){return a()})},c}(Backbone.Router),null==window.kb&&(window.kb={}),null==window.kb.Navigation&&(window.kb.Navigation=d),c=function(){function a(a,b){this.save=f(this.save,this),this.getList=f(this.getList,this),this.switchComplete=f(this.switchComplete,this),this.addItem=f(this.addItem,this),this.viewModel=a,this.options=b}return a.prototype.addItem=function(){var a,c;return a={listID:this.viewModel.activeListID(),listItemID:window.guidGenerator(),dateAdded:new Date,dateComplete:null,bComplete:!1,text:this.viewModel.listEntry()},c=this.viewModel.activeList(),c.push(new b(a)),this.viewModel.activeList(c),this.save(a,null,function(a){return function(){return a.viewModel.errorMessage("Opps. Service Failed.")}}(this))},a.prototype.switchComplete=function(a){var b;return a.bComplete(a.bComplete()?!1:!0),b={listID:a.listID(),listItemID:a.listItemID(),dateAdded:a.dateAdded(),dateComplete:a.dateComplete(),bComplete:a.bComplete(),text:a.text()},this.save(b,function(){return function(){}}(this),function(a){return function(){return a.viewModel.errorMessage("Opps. Service Failed.")}}(this))},a.prototype.getList=function(a,b,c){var d;return d={listID:a},$.ajax({url:window.constants.serviceURL+"/ListItem/GetAll",type:"post",data:d,dataType:"json",cache:!1,xhrFields:{withCredentials:!0},error:function(){return function(){return null!=c?c():void 0}}(this),success:function(){return function(a){if("success"===a.result){if(null!=b)return b(a.items)}else if(null!=c)return c(a.reason)}}(this)})},a.prototype.save=function(a,b,c){var d;return d={listID:a.listID,listItemID:a.listItemID,dateAdded:null!=a.dateAdded?moment(a.dateAdded).format():null,dateCompleted:null!=a.dateAdded?moment(a.dateCompleted).format():null,bComplete:a.bComplete,text:a.text},$.ajax({url:window.constants.serviceURL+"/listItem/Save",type:"post",data:d,dataType:"json",cache:!1,xhrFields:{withCredentials:!0},error:function(){return function(){return null!=c?c():void 0}}(this),success:function(){return function(a){if("success"===a.result){if(null!=b)return b(a.item)}else if(null!=c)return c(a.reason)}}(this)})},a}(),null==window.kb&&(window.kb={}),null==window.kb.ListItemHelper&&(window.kb.ListItemHelper=c),e=function(){function a(a){this.convertTimeformat=f(this.convertTimeformat,this),this.getDateTime=f(this.getDateTime,this),this.viewModel=a}return a.prototype.getDateTime=function(a){var b,c,d,e,f,g,h,i,j,k;return b=new Date,null!=a&&b.setDate(b.getDate()+a),d=b.getHours(),d=(null!=(i=10>d)?i:{0:""})+d,e=b.getMinutes(),e=(null!=(j=10>e)?j:{0:""})+e,g=b.getSeconds(),g=(null!=(k=10>g)?k:{0:""})+g,h=b.getFullYear(),f=b.getMonth()+1,10>f&&(f="0"+f.toString()),c=b.getDate(),10>c&&(c="0"+c.toString()),h+":"+f+":"+c+":"+d+":"+e+":"+g},a.prototype.convertTimeformat=function(a,b){var c,d,e,f,g;return d=Number(b.match(/^(\d+)/)[1]),e=Number(b.match(/:(\d+)/)[1]),c=b.match(/\s(.*)$/)[1],"PM"===c&&12>d&&(d+=12),"AM"===c&&12===d&&(d-=12),f=d.toString(),g=e.toString(),10>d&&(f="0"+f),10>e&&(g="0"+g),f+":"+g},a.prototype.back=function(){return window.history.back()},a.prototype.foundiOS=function(){return null!=this._foundiOS?this._foundiOS:!this.foundDevice()||0!==device.platform.lastIndexOf("iPhone",0)&&0!==device.platform.lastIndexOf("iPad",0)&&0!==device.platform.lastIndexOf("iPhone Simulator",0)?(this._foundiOS=!1,this.foundiOS()):(this._foundiOS=!0,this.foundiOS())},a.prototype.foundConnection=function(){return!this.foundDevice()||navigator.network.connection.type!==Connection.UNKNOWN&&navigator.network.connection.type!==Connection.NONE?!0:!1},a.prototype.foundAndroid=function(){return null!=this._foundAndroid?this._foundAndroid:this.foundDevice()&&"Android"===device.platform?(this._foundAndroid=!0,this.foundAndroid()):(this._foundAndroid=!1,this.foundAndroid())},a.prototype.foundDevice=function(){return"undefined"!=typeof device&&null!==device?!0:!1},a}(),window.guidGenerator=function(){var a;return a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},window.checkdate=function(a){var b,c,d,e,f,g;return f=/^\d{2}\/\d{2}\/\d{4}$/,e=!1,f.test(a)?(d=a.split("/")[0],b=a.split("/")[1],g=a.split("/")[2],c=new Date(g,d-1,b),c.getMonth()+1!==d||c.getDate()!==b||c.getFullYear()!==g?!1:!0):!1},window.validateEmail=function(a){var b;return b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,b.test(a)},"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a){return 0===this.indexOf(a)}),window.isDate=function(a){return"string"==typeof a&&a.startsWith("/Date(")},window.deserializeDate=function(a){return new Date(parseInt(a.substr(6),10))},window.isScalar=function(a){return null===a||"string"==typeof a||"number"==typeof a||"boolean"==typeof a},Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c,d,e;for(null==b&&(b=0),c=d=b,e=this.length(-1);e>=b?e>d:d>e;c=e>=b?++d:--d)if(this[c]===a)return c;return-1}),window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(null!=window.location.port?":"+window.location.port:""))}).call(this);